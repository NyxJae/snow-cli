# Snow CLI 使用文档——指令面板说明

指令面板是 Snow CLI 提供的快捷命令系统，让您可以通过简单的斜杠命令快速执行各种操作。

## 指令面板概述

所有指令都以 `/` 开头，在聊天输入框中输入即可执行。指令分为以下几类：

- 会话管理
- 模式切换
- 代码审查与分析
- 配置与管理
- 自定义扩展

## 会话管理指令

### `/clear`

清除当前聊天上下文。

- **作用**: 清空当前对话历史，开始全新的对话
- **使用场景**: 当对话上下文过长或需要切换话题时
- **示例**: 直接输入 `/clear` 并回车

### `/resume`

恢复历史会话。

- **作用**: 打开会话选择面板，可以选择并恢复之前保存的对话
- **使用场景**: 需要继续之前未完成的对话或查看历史记录
- **示例**: 输入 `/resume` 查看所有保存的会话

### `/export`

导出对话记录。

- **作用**: 将当前对话导出为文本文件
- **使用场景**: 需要保存对话内容用于文档或分享
- **示例**: 输入 `/export` 自动保存到项目目录

### `/compact`

压缩对话历史。

- **作用**: 使用 AI 压缩对话历史，减少 token 使用
- **使用场景**: 对话过长但不想清除，需要保留关键信息
- **示例**: 输入 `/compact` 开始压缩

## 模式切换指令

### `/yolo`

切换 YOLO 模式（自动批准模式）。

- **作用**: 开启/关闭工具调用自动批准，无需手动确认
- **使用场景**: 信任 AI 操作时快速执行，或需要人工审核时关闭
- **状态**: 状态保存在 localStorage，重启后保持
- **示例**: 输入 `/yolo` 切换模式

### `/plan`

切换 Plan 模式（计划模式）。

- **作用**: 开启/关闭计划模式，AI 会先制定详细计划再执行
- **使用场景**: 复杂任务需要先规划，或简单任务直接执行
- **状态**: 状态保存在 localStorage
- **示例**: 输入 `/plan` 切换模式

### `/vulnerability-hunting`

切换漏洞猎人模式。

- **作用**: 开启/关闭漏洞猎人模式，这是一个专业的安全分析代理
- **功能**:
  - 系统化的 5 阶段漏洞分析流程
  - 生成可执行的验证脚本
  - 创建详细的安全分析报告
  - 支持多种漏洞类型检测（逻辑错误、安全漏洞等）
- **使用场景**: 进行专业的安全审计或代码漏洞检测
- **状态**: 状态保存在 localStorage
- **报告位置**: `.snow/vulnerability-hunting/docs/`
- **脚本位置**: `.snow/vulnerability-hunting/scripts/`
- **详细说明**: 参考 [漏洞猎人模式](./11.漏洞猎人模式.md)
- **示例**: 输入 `/vulnerability-hunting` 切换模式

## 代码审查与分析指令

### `/review`

代码审查。

- **作用**: 打开交互式代码审查面板，选择要审查的内容
- **功能**:
  - 自动检测 Git 仓库
  - 显示已暂存更改（Staged）及文件数量
  - 显示未暂存更改（Unstaged）及文件数量
  - 分页加载历史提交记录（每页 30 条）
  - 支持多选：可同时选择多个审查目标
  - 支持添加审查备注
  - AI 分析代码质量、潜在 bug、安全问题
  - 提供优化建议
- **面板操作**:
  - `Up/Down` - 上下移动选择
  - `Space` - 勾选/取消勾选当前项
  - `Enter` - 确认选择并开始审查
  - `ESC` - 关闭面板
- **可选择的审查目标**:
  - **Staged**: 已暂存的更改
  - **Unstaged**: 未暂存的更改
  - **历史提交**: 显示 commit SHA、提交信息、作者、日期
- **示例**:
  - `/review` - 打开审查面板
  - 在面板中用空格键选择要审查的内容，按回车确认

### `/init`

初始化项目文档。

- **作用**: AI 分析当前项目并生成/更新 AGENTS.md 文档
- **功能**:
  - 自动探索项目结构
  - 读取配置文件和代码
  - 生成项目概述、技术栈、架构说明
- **生成内容**: 项目名称、概览、技术栈、目录结构、功能特性、使用说明等
- **示例**: 在项目根目录输入 `/init`

### `/role`

角色定义文件管理。

- **作用**: 管理 ROLE 文件（支持全局与项目两个作用域），用于定义 AI 的角色和行为
- **功能**:
  - **创建**: `/role` - 打开交互式面板，选择创建位置
    - 全局位置: `~/.snow/ROLE.md`
    - 项目位置: `./ROLE.md`
  - **删除**: `/role -d` 或 `/role --delete` - 打开删除面板，选择要删除的 ROLE.md
  - **列表/切换**: `/role -l` 或 `/role --list` - 打开 ROLE 管理面板，查看当前作用域下的 ROLE 列表并切换活跃项
- **使用场景**: 需要为特定项目定制 AI 的行为与输出风格，或统一配置所有项目的 AI 行为
- **面板操作**:
  - **创建面板**: `G` - 选择全局，`P` - 选择项目，`ESC` - 取消
  - **删除面板**: `G` - 删除全局，`P` - 删除项目，`Y` - 确认删除，`N/ESC` - 取消
  - **ROLE 管理面板（/role -l）**:
    - `Tab` - 切换 Global / Project
    - `Up/Down` - 移动选择
    - `Enter` - 将选中的 ROLE 设为活跃（列表中以 `[✓]` 标记）
    - `N` - 创建一个新的非活跃 ROLE（文件名形如 `ROLE-<id>.md`）
    - `D` - 删除选中的非活跃 ROLE（需要二次确认：`Y` 确认，`N/ESC` 取消）
    - `ESC` - 关闭面板
- **活跃状态持久化**:
  - 全局: `~/.snow/role.json`
  - 项目: `<项目根目录>/.snow/role.json`
  - 字段: `activeRoleId`（缺省或为 `active` 表示读取 `ROLE.md`；否则读取 `ROLE-<activeRoleId>.md`）
- **示例**:
  - `/role` - 打开创建面板，选择位置后创建 ROLE.md
  - `/role -d` - 打开删除面板，选择要删除的文件
  - `/role -l` - 打开 ROLE 管理面板

### `/reindex`

重建代码库索引。

- **作用**: 重新扫描并索引项目代码库
- **前提**: 需要先在配置中启用代码库功能
- **参数**:
  - 无参数: 增量重建，跳过未修改的文件
  - `-force`: 强制重建，删除现有数据库后完全重建索引
- **使用场景**:
  - 代码库更新后需要更新索引
  - 索引损坏时使用 `-force` 完全重建
- **示例**:
  - `/reindex` - 增量重建索引
  - `/reindex -force` - 强制完全重建索引

## 配置与管理指令

### `/home`

返回欢迎页。

- **作用**: 返回 Snow CLI 主菜单/欢迎界面
- **功能**:
  - 暂停代码库索引
  - 清除 API 配置缓存
  - 重置客户端连接
- **示例**: 输入 `/home` 返回主页

### `/ide`

连接 IDE 插件。

- **作用**: 连接到 VSCode 或 JetBrains IDE 插件
- **功能**:
  - 自动检测并连接 IDE
  - 显示连接端口
  - 强制重连（如已连接）
- **前提**: 需要先安装对应的 IDE 插件
- **示例**: 输入 `/ide` 建立连接

### `/mcp`

查看 MCP 服务。

- **作用**: 打开 MCP（Model Context Protocol）服务面板
- **功能**: 显示已配置的 MCP 服务列表和状态
- **示例**: 输入 `/mcp` 查看服务

### `/usage`

查看使用统计。

- **作用**: 打开使用统计面板
- **功能**: 显示 token 使用量、API 调用次数等统计信息
- **示例**: 输入 `/usage` 查看统计

### `/permissions`

管理工具权限。

- **作用**: 打开权限管理面板
- **功能**: 管理始终批准的工具列表，控制哪些工具可以自动执行
- **使用场景**: 需要配置工具的自动批准权限，或撤销某些工具的自动执行权限
- **示例**: 输入 `/permissions` 打开权限面板

### `/help`

帮助信息。

- **作用**: 打开帮助面板
- **功能**: 显示快捷键、常用指令说明
- **示例**: 输入 `/help` 或按 `?` 键

### `/quit`

退出程序。

- **作用**: 安全退出 Snow CLI 应用
- **功能**:
  - 停止代码库索引
  - 断开 VSCode 连接
  - 清理资源
- **示例**: 输入 `/quit` 或按 `Ctrl+C`

### `/add-dir`

添加工作目录。

- **作用**: 添加项目目录到工作目录列表（支持本地目录与 SSH 远程目录）
- **使用方式**:
  - 无参数: `/add-dir` - 打开目录管理面板
  - 带本地路径: `/add-dir /path/to/project` - 直接添加本地目录
  - 远程目录: 需要在面板中按 `S` 进入「添加 SSH 远程目录」模式，填写主机/端口/用户名/认证方式/远程路径后添加
- **配置文件**: `.snow/working-dirs.json`
- **示例**:
  - `/add-dir` - 打开面板管理（`A` 添加本地，`S` 添加 SSH，`D` 删除已标记）
  - `/add-dir D:\projects\myapp` - 直接添加本地目录

### `/backend`

查看后台进程。

- **作用**: 打开后台进程管理面板
- **功能**:
  - 显示所有后台运行的命令
  - 查看进程状态（运行中、已完成、失败）
  - 查看进程输出和运行时长
  - 支持终止正在运行的进程
- **面板操作**:
  - `↑/↓` - 选择进程
  - `Enter` - 终止选中的运行中进程
  - `ESC` - 关闭面板
- **使用场景**: 管理通过 `Ctrl+B` 移入后台的长时间运行命令
- **示例**: 输入 `/backend` 查看后台进程

### `/profiles`

打开配置文件切换面板。

- **作用**: 打开 Profile（配置文件）选择面板（用于切换配置）
- **使用场景**: 快捷键冲突或不方便按键时，可直接通过命令打开面板
- **示例**: 输入 `/profiles` 打开配置选择面板

### `/models`

打开模型切换面板。

- **作用**: 打开模型切换面板，快速切换当前使用的 AI 模型
- **功能**:
  - 显示当前配置的 API 提供商的可用模型列表
  - 支持搜索过滤模型
  - 实时切换对话使用的模型
  - 支持切换思考强度设置（适用于支持思考功能的模型）
- **面板标签**:
  - **Advanced**: 高级模型设置
  - **Basic**: 基础模型设置
  - **Thinking**: 思考功能配置（显示思考过程、启用思考、思考强度等）
- **使用场景**: 需要快速切换不同的 AI 模型进行对话，或调整模型的思考强度
- **示例**: 输入 `/models` 打开模型选择面板

## 自定义扩展指令

### `/custom`

创建自定义命令。

- **作用**: 打开自定义命令配置面板
- **功能**:
  - 创建新的自定义指令
  - 支持两种类型：
    - **execute**: 在终端执行命令
    - **prompt**: 发送提示词给 AI
  - 支持全局和项目级别
  - **支持补充输入**: 可以在指令后面添加额外参数，会自动叠加到命令或提示词后面
- **存储位置**:
  - 全局: `~/.snow/commands/`
  - 项目: `.snow/commands/`
- **示例**:
  - 输入 `/custom` 打开配置界面
  - 使用补充输入: `/mycommand 额外参数` - 参数会叠加到原命令或提示词后面

#### `description` 字段（可选）

自定义命令的 JSON 文件支持可选字段 `description`，用于在指令面板（输入 `/` 的候选列表）里显示更简短的说明，避免长 prompt 占用大量终端空间。

- **兼容策略**: 未设置 `description` 时，会回退显示 `command`（对于 `type: "prompt"` 的命令即为完整提示词），因此旧命令文件无需修改。
- **设置方式**: 使用 `/custom` 创建命令时可填写该字段；留空则视为未设置。

**示例：**

```json
{
	"type": "prompt",
	"command": "请根据当前对话生成一份简短总结",
	"description": "总结当前对话"
}
```

#### 命名空间自定义指令

自定义指令支持命名空间格式：`/<namespace>:<command> [args...]`。

当你需要按功能/团队/环境对指令进行分组管理时，这会非常有用。

**目录映射（指令名由文件路径推导）：**

- `.snow/commands/build.json` -> `/build`
- `.snow/commands/deploy/stage.json` -> `/deploy:stage`
- `.snow/commands/deploy/prod.json` -> `/deploy:prod`

同样的规则也适用于全局目录 `~/.snow/commands/`。

**注意事项 / 限制：**

- 参数以空格分隔：`/deploy:stage --dry-run`
- `:` 仅作为命名空间分隔符使用。
- namespace 使用 `/` 作为目录层级分隔。
- namespace 的每一段不能是 `.` 或 `..`，且不能包含 `:` 或 `\\`。
- command 部分不能包含空白、`\\`、`/` 或 `:`（且不能是 `.` 或 `..`）。

### `/skills`

创建技能模板。

- **作用**: 打开技能创建对话框
- **功能**:
  - 生成 SKILL.md（主文档）
  - 生成 reference.md（详细参考）
  - 生成 examples.md（使用示例）
  - 创建 templates/（模板文件）
  - 创建 scripts/（辅助脚本）
- **存储位置**:
  - 全局: `~/.snow/skills/`
  - 项目: `.snow/skills/`
- **命名规则**: 小写字母、数字、连字符；可用 `/` 作为命名空间分隔（每段最多 64 字符）
- **目录映射**: `~/.snow/skills/<namespace>/<skill>/SKILL.md` -> skill id `<namespace>/<skill>`
- **示例**: 输入 `/skills`，在对话框里填入 `team/my-skill` 创建技能

### 删除自定义命令/技能

创建自定义命令后，可以使用 `/<命令名> -d` 删除：

- **删除自定义命令**: `/mycommand -d`
- **位置识别**: 自动识别全局或项目级别
- **示例**: 如果创建了 `/deploy` 命令，使用 `/deploy -d` 删除
- **命名空间示例**: 如果创建了 `/deploy:stage` 命令，使用 `/deploy:stage -d` 删除

## 特殊指令

### `/agent-`

选择子代理。

- **作用**: 打开子代理选择面板
- **功能**: 选择不同的专用子代理（探索、计划、通用等）
- **使用场景**: 需要特定类型的 AI 助手时
- **示例**: 输入 `/agent-` 查看可用代理

### `/todo-`

TODO 注释选择器。

- **作用**: 打开 TODO 注释选择面板
- **功能**: 扫描代码中的 TODO 注释并进行管理
- **使用场景**: 快速查看和处理代码中的待办事项
- **示例**: 输入 `/todo-` 打开选择器

## 快捷键

除了斜杠指令，还有一些便捷的快捷键：

- `Ctrl+P`/`Alt+P`: 切换配置文件（Profile）
- `Ctrl+L`: 向前清除输入框
- `ESC`: 中断 AI 响应
- `↑/↓`: 浏览历史输入

## 使用技巧

1. **自动补全**: 输入 `/` 后会显示所有可用指令，可以使用方向键选择

2. **指令组合**: 某些指令可以与模式组合使用，例如：

   - 开启 `/yolo` 模式后执行 `/review` 可以快速审查代码
   - 开启 `/plan` 模式后执行 `/init` 会生成更详细的项目文档

3. **自定义工作流**: 使用 `/custom` 创建常用操作的快捷指令

   - 例如创建 `/deploy` 执行部署脚本
   - 创建 `/test` 运行测试命令

4. **技能复用**: 使用 `/skills` 创建可复用的任务模板

   - 代码生成模板
   - 文档模板
   - 测试用例模板
   - 详细说明请参考 [Skills 指令详细说明](./18.Skills指令详细说明.md)

5. **会话管理**: 定期使用 `/export` 备份重要对话，使用 `/compact` 压缩长对话

## 常见问题

### Q: 指令不生效怎么办？

A: 检查以下几点：

- 确认指令拼写正确（区分大小写）
- 某些指令有前置条件（如 `/reindex` 需要启用代码库）
- 查看错误提示信息

### Q: 如何查看所有可用指令？

A: 输入 `/` 然后等待，会显示自动补全列表，或使用 `/help` 查看帮助

### Q: 自定义指令保存在哪里？

A:

- 全局指令: `~/.snow/commands/`
- 项目指令: `<项目根目录>/.snow/commands/`

### Q: 如何在不同项目间共享自定义指令？

A: 创建指令时选择"全局"位置，或手动复制 `.snow/commands/` 目录到其他项目

## 相关配置

- [敏感命令配置](./06.敏感命令配置.md) - 配置需要确认的危险操作
- [Hooks 配置](./07.Hooks配置.md) - 配置指令执行前后的自动化操作
- [代码库设置](./04.代码库设置.md) - 配置代码库索引功能（`/reindex` 所需）
- [命令注入模式](./10.命令注入模式.md) - 在消息中直接执行命令的高级功能
- [漏洞猎人模式](./11.漏洞猎人模式.md) - 专业的安全分析和漏洞检测功能
