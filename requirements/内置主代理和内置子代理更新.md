# 需求文档

## 1. 项目现状与核心目标

目前项目内置主代理和内置子代理存在代码硬编码配置,但用户已经在本地形成了统一的配置文件:

- C:/Users/Administrator/.snow/main-agents.toml
- C:/Users/Administrator/.snow/sub-agents.toml

核心目标: 项目内的“内置主代理/内置子代理”与上述配置文件完全一致,并且界面显示顺序与配置文件顺序一致. 包含新增的 Architect 主代理,同时移除配置文件中已不存在的内置代理(例如 leader, vulnerability_hunter).

## 2. 范围与边界

**功能点简述**:

- [ ] 主代理列表以 main-agents.toml 为唯一来源,内置主代理列表与其完全一致.
- [ ] 主代理顺序严格按 main-agents.toml 中的出现顺序展示,并影响:
  - 主代理配置界面列表顺序.
  - ChatScreen 主代理快捷选择窗口顺序.
  - 主代理切换(如“切换到下一个主代理”)的循环顺序.
- [ ] 新增/保留: main-agents.toml 中的 Architect 必须作为“内置主代理”参与上述顺序.
- [ ] 删除: 任何 main-agents.toml 未出现的内置主代理必须从代码硬编码中移除(例如 leader, vulnerability_hunter).
- [ ] 子代理列表以 sub-agents.toml 为唯一来源,内置子代理列表与其完全一致.
- [ ] 删除: sub-agents.toml 未出现的内置子代理必须从代码硬编码中移除(例如 agent_plan, agent_code_reviewer).
- [ ] 新增/保留: sub-agents.toml 中存在的子代理必须作为内置子代理存在(例如 agent_reviewer, agent_explore, agent_general, agent_todo_progress_useful_info_admin).

**排除项**:

- 不修改本地配置文件本身.
- 不调整配置文件内每个代理的具体内容(如 prompt, tools),只同步“有哪些代理”和“顺序”.
- 不新增额外的默认代理或隐藏代理.

## 3. 举例覆盖需求和边缘情况

- **例 1: 主代理顺序同步**

  - main-agents.toml 顺序: general -> requirement_analyzer -> Architect -> debugger.
  - 结果: 主代理配置界面与 ChatScreen 快捷选择窗口显示顺序必须与上面一致,切换到下一个主代理也按此顺序循环.

- **例 2: 删除旧主代理**

  - 如果 main-agents.toml 不包含 leader 和 vulnerability_hunter.
  - 结果: 项目内置主代理列表中不能再出现这两项,相关的内置配置也不再被加载.

- **例 3: 子代理替换**

  - sub-agents.toml 仅包含 agent_reviewer, agent_explore, agent_general, agent_todo_progress_useful_info_admin.
  - 结果: 内置子代理只保留这 4 个. 例如原先硬编码的 agent_code_reviewer 不再出现,由 agent_reviewer 替代.

- **例 4: 配置文件唯一来源**
  - 如果某内置代理在代码中存在,但配置文件未出现.
  - 结果: 该代理不应在任何界面显示,也不应参与内置顺序.直接从代码中完全删掉他
