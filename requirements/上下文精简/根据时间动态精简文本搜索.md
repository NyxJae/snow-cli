<!-- # 需求文档：动态精简ace-text_search工具返回内容

## 1. 项目现状与核心目标

### 1.1 项目现状

- 项目中文本搜索工具（ace-text_search）的返回结果包含时间戳（timestamp 字段，毫秒级数字）
- 工具返回结果通过  数组传递给 AI API
- 搜索结果可能包含大量输出，占用大量上下文

### 1.2 核心目标

动态精简会话上下文中的ace-text_search工具返回内容，实现：

- 减少老旧搜索结果输出对上下文的占用
- 保留关键的错误信息，避免 Agent 重复犯错
- 一定保留最近的5次搜索结果,5次之前的超过10分钟的搜索结果精简
- 以 "本次搜索结果已过时,故精简为占位符" 精简
- 如需详情，Agent 可重新执行命令

**重要原则**：

- ⭐ **只精简发送给 API 的上下文**：不影响会话持久化存储
- ⭐ **会话文件完整记录**：本地会话文件如实保存所有原始内容，不做任何精简
- ⭐ **精简是临时的**：每次发送给 API 前动态计算精简，不修改历史数据 -->

已完成